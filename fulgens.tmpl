#!/usr/bin/env bash

trap cleanup 2
set -e

{{ functions }}

verbosePrint() {
	if [ "$VERBOSE" == "YES" ]; then
		echo -e "$1"
	fi
}

{{ cleanup }}

{{ options }}

{{ dependencycheck }}

# clean if requested
if [ -n "$CLEAN" ]; then
  if [ "$CLEAN" == "all" ]; then
    if [ "$VERBOSE" == "YES" ]; then echo "rm -rf localrun"; fi
    rm -rf localrun
  fi
  {{ clean }}
fi

{{ globalvariables }}

mkdir -p localrun

f_deploy() {
	echo "No plugin defined f_deploy()"
}

{{ prepare }}

{{ plugins }}

{{ wait }}
